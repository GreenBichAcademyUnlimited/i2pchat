#üòÄÔ∏èlanguage: cpp
#git:
#  depth: 1
#
#addons:
#  apt:
#    sources:
#      - george-edison55-precise-backports
#    packages:
#      - cmake-data
#      - cmake
#
#matrix:
#  include:
#    # works on Precise and Trusty
#    - os: linux
#      addons:
#        apt:
#          sources:
#            - ubuntu-toolchain-r-test
#          packages:
#            - g++-4.9
#      env:
#         - MATRIX_EVAL="CC=gcc-4.9 && CXX=g++-4.9"
#    - os: osx
#      osx_image: xcode8
#      env:
#        - MATRIX_EVAL="CC=gcc-4.9 && CXX=g++-4.9"
#
#   - os: osx
#      osx_image: xcode8
#      env:
#        - MATRIX_EVAL="brew install gcc5 && CC=gcc-5 && CXX=g++-5"
#
#    - os: osx
#      osx_image: xcode8
#      env:
#        - MATRIX_EVAL="brew install gcc6 && CC=gcc-6 && CXX=g++-6"
#
#    - os: osx
#      osx_image: xcode8
#      env:
#        - MATRIX_EVAL="brew install gcc && CC=gcc-7 && CXX=g++-7"
#    # works on Precise and Trusty
#    - os: linux
#      addons:
#        apt:
#          sources:
#            - ubuntu-toolchain-r-test
#          packages:
#            - g++-5
#      env:
#         - MATRIX_EVAL="CC=gcc-5 && CXX=g++-5"
#
language: cpp
matrix:
  include:
  - os: linux
    dist: xenial
    before_install:
    - sudo apt-get update -qq
    - sudo apt-get install devscripts build-essential lintian dh-make
    - sudo apt-get install qtdeclarative5-dev qt5-default libjack-jackd2-dev
    compiler:
    - clang
    - gcc
    script:
    - echo $TRAVIS_TAG
    - qmake I2P-Messenger.pro
    - make
    #ssh-key & deploy function is only available in travis-ci.com (not free) but not in travis-ci.org (free)
    #deploy:
    #  provider: releases
    #  api_key:
    #    secure: <key>
    #  file:
    #  - I2P-Messenger
    #  skip_cleanup: true
    #  on:
    #    repo: wipedlifepotato/i2pchat
    #    tags: true
  - os: osx
    osx_image: xcode7.2
    before_install:
    - brew install qt5
    - brew link qt5 --force
    script:
    - qmake -spec macx-xcode I2P-Messenger.pro
    - xcodebuild -list -project Jamulus.xcodeproj
    - xcodebuild -scheme Jamulus build
    #ssh-key & deploy function is only available in travis-ci.com (not free) but not in travis-ci.org (free)
    #deploy:
    #  provider: releases
    #  api_key:
    #    secure: <key>
    #  file:
    #  - file.app
    #  skip_cleanup: true
    #  on:
    #    repo: wipedlifepotato/i2pchat
    #    tags: true
  - os: windows
    before_install:
    - dir C:/Program\ Files\ \(x86\)/Windows\ Kits/10/bin/10.0.17134.0/x64
    - cmd.exe /C 'cd && "C:\Program Files (x86)\Microsoft Visual Studio\2017\BuildTools\VC\Auxiliary\Build\vcvarsall.bat"
      x86 && cd && cd "C:/Users/travis/build/wipedlifepotato/i2pchat" && dir'
    - curl -vLO http://download.qt.io/official_releases/online_installers/qt-unified-windows-x86-online.exe
    - curl -vLO http://www.steinberg.net/sdk_downloads/ASIOSDK2.3.2.zip
    - unzip ASIOSDK2.3.2.zip
    - mkdir windows/ASIOSDK2
    - cp -rvu ASIOSDK2.3.2/* windows/ASIOSDK2
    - "./qt-unified-windows-x86-online.exe --verbose --script qt-installer-windows.qs"
    - ls -la C:/Qt/5.12.3/msvc2017/bin/qtenv2.bat
    script:
    - cmd.exe /C 'cd && "C:\Qt\5.12.3\msvc2017\bin\qtenv2.bat" && cd && "C:\Program
      Files (x86)\Microsoft Visual Studio\2017\BuildTools\VC\Auxiliary\Build\vcvarsall.bat"
      x86 && cd "C:\Users\travis\build\braindef\jamulus" && cd && qmake I2P-Messenger.pro
      && nmake'
    #ssh-key & deploy function is only available in travis-ci.com (not free) but not in travis-ci.org (free)
    #deploy:
    #  provider: releases
    #  api_key:
    #    secure: <key>
    #  file:
    #  - file.exe
    #  skip_cleanup: true
    #  on:
    #    repo: wipedlifepotato/i2pchat
    #    tags: true



    # works on Precise and Trusty
    - os: linux
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - g++-6
      env:
        - MATRIX_EVAL="CC=gcc-6 && CXX=g++-6"

    # works on Precise and Trusty
    - os: linux
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - g++-7
      env:
        - MATRIX_EVAL="CC=gcc-7 && CXX=g++-7"

before_install:
    - eval "${MATRIX_EVAL}"
